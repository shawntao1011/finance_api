---
title: Wind Instruction
author: Tao Sun
date: 2021-12-07 10:52:00 +0800
category: Instruction
layout: post
---
## 如何使用wind API
1. 修复插件

    点击wind终端 左上角"我的" --> "插件修复" --> "修复python接口"

2. 调用wind.start()
    ```python
    from WindPy import w as wind
    wd = wind.start()
    assert 0 == wd.ErrorCode,\
            f"WindQuantAPI login error {wd.ErrorCode}: {wd.iloc[0][0]}"
    ```

3. 调用wind相关函数
    根据Wind CG(code generator) 生成相关函数的format，再自定义parse相关参数。
    
    eg: 假设需要获取某个基金(000001.OF)的日收益率数据，
    WIND CG中的代码示例则如下:
    ```
    w.wsd("000001.OF", "NAV_adj_return1", "2021-11-07", "2021-12-06", "")
    ```
    那么实际的python 代码为
    ```python
    w.wsd("000001.OF", "NAV_adj_return1", "2021-11-07", "2021-12-06", "", usedfdt=True) 
    ```
    其中，usedfdt 参数用于 确保返回是一个pd.Dataframe 且 空的时间字段会作为pd.NaT返回，而不是dt.datetime(1899,12,31)


## Wind 接口解读

&nbsp;&nbsp;&nbsp;&nbsp;wind 的数据接口主要限制在三个维度:
1. Days
2. Indicators
3. WindCodes 

<img src="C:\Users\tao.sun\AppData\Roaming\Typora\typora-user-images\image-20211207134715381.png" alt="image-20211207134715381" style="transform: rotate(-90deg); zoom: 25%;">

在单次的query中，在以上三个维度至少需要一个维度为 1(1天，1个变量或一个股票)。







